# SPgo
De novo design of Sec-type signal peptides

# SPgo: Signal Peptide Generator with Rule-based and BERT-LSTM Design

**SPgo** is a hybrid signal peptide generation model that combines biological prior knowledge with deep learning. Specifically, it generates the N-region and C-region using rule-based templates, while the hydrophobic H-region is generated using a BERT-embedded bi-directional LSTM decoder. This design ensures both biological interpretability and modeling flexibility.

## 🔧 Features

- Specialized for signal peptide synthesis
- Rule-based generation for N-region and C-region to enforce biological constraints
- Context-aware H-region generation using BERT + BiLSTM
- Mixed-precision training support
- Top-k and Top-p sampling strategies for controlled decoding
- Input/output compatible with standard FASTA format
- Supports downstream evaluation with SignalP6

## 🚀 Quick Start

### 1. Install requirements

```bash
pip install -r requirements.txt
```

### 2. Train the model

Place your signal peptide FASTA-formatted data under `data/`, then run:

```bash
python model/training.py
```

### 3. Generate new signal peptides

After training or using pretrained checkpoints:

```bash
python model/Sequence_generation.py
```

### 4. Predict signal peptide functionality (optional)

SPgo supports functional validation using [SignalP6](https://services.healthtech.dtu.dk/service.php?SignalP-6.0). To do this:

1. Concatenate generated signal peptides with your target protein sequences.
2. Format as FASTA and save to file.
3. Submit the file to a local or web-based instance of SignalP6 (must be installed or accessed separately).

> Note: SignalP6 is not included in this repository. Users must download or access it independently.

## ⚙️ How It Works

SPgo divides a signal peptide into three biologically defined regions:

- **N-region**: Generated by handcrafted rules (typically positively charged)
- **H-region**: Learned using a BERT-embedded BiLSTM model (typically hydrophobic core)
- **C-region**: Generated by handcrafted rules (contains cleavage site motifs)

This hybrid strategy allows SPgo to retain known biological patterns while learning complex internal features from data. After sequence generation, the complete signal peptide is prepended to a user-defined protein sequence, forming the full construct for SignalP6-based validation.

## 📁 Input Format

Provide training sequences in standard FASTA format:

```
>seq1
MKTAYIAKQRQISFVKSHFSRQ...
>seq2
GPHMIVNIEKPQLLLKTLQVL...
```

## 📂 Project Structure

```
SPgo/
├── model/
│   ├── training.py               # Model definition and training script
│   └── Sequence_generation.py    # Sequence generation script
├── data/                         # Input FASTA files
├── checkpoints/                  # Trained model weights (The checkpoint file can be downloaded at https://drive.google.com/file/d/1ElvvCBtIcbXLl4MakJ6_VIGdzHD1nV6W)
├── requirements.txt              # Required Python packages
└── README.md
```

## 🧬 Example Output

The generated sequences will follow signal peptide structure and be saved in FASTA format:

```
>generated_signal_peptide_1
MRRLLALALALALAAQAFA...
```

## 📚 References

- Devlin et al., BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. [arXiv:1810.04805](https://arxiv.org/abs/1810.04805)
- Nielsen, H., et al. SignalP: Signal peptide prediction using neural networks. *Protein Engineering* (1997).
- Teufel et al., SignalP 6.0 predicts all five types of signal peptides using protein language models. *Nature Biotechnology* (2022).
- For a video of SPgo in action, see https://drive.google.com/file/d/1iWw7QOF2OZsCTW5z7DuvZxUGYm-hJgp7/view?usp=sharing
